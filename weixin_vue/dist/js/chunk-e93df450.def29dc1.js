(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e93df450"],{"18bf":function(t,o,e){},"44e1":function(t,o,e){"use strict";var a=e("18bf"),i=e.n(a);i.a},"4d0b":function(t,o,e){"use strict";var a=e("fba2"),i=e.n(a);i.a},"4d60":function(t,o,e){"use strict";e.r(o);var a=function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("onekit-page",[e("import",{attrs:{src:"../../../common/head.vue"}}),e("import",{attrs:{src:"../../../common/foot.vue"}}),e("onekit-view",{staticClass:"container"},[e("onekit-view",{staticClass:"page-body"},[e("onekit-view",{staticClass:"page-section"},[e("onekit-view",{staticClass:"weui-cells__title"},[t._v("内容")]),e("onekit-view",{staticClass:"weui-cells weui-cells_after-title"},[e("onekit-view",{staticClass:"weui-cell weui-cell_input"},[e("onekit-view",{staticClass:"weui-cell__bd"},[e("onekit-input",{staticClass:"weui-input",attrs:{placeholder:"请输入内容",value:t.description},on:{input:t.onInputContent}})],1)],1)],1),e("onekit-view",{staticClass:"btn-area"},[e("onekit-button",{attrs:{type:"primary",size:"40",loading:t.updating},on:{tap:t.updateTodo}},[t._v("更新 Todo")]),e("onekit-button",{attrs:{type:"warn",size:"40",loading:t.deleting},on:{tap:t.removeTodo}},[t._v("删除 Todo")])],1)],1)],1)],1)],1)},i=[],n=(e("a4d3"),e("e01a"),e("711f")),s=e("79f0"),d=getApp();Object(n["OnekitPage"])({onShareAppMessage:function(){return{title:"基本操作",path:"page/cloud/pages/crud/crud"}},data:{openid:"",todoId:"",description:"",done:!1,updating:!1,deleting:!1},onLoad:function(t){var o=this,e=t.todoId;this.setData({todoId:e}),d.globalData.openid?(this.setData({openid:d.globalData.openid}),this.queryTodo()):(s["a"].showLoading({title:"正在初始化..."}),d.getUserOpenIdViaCloud().then((function(t){return o.setData({openid:t}),s["a"].hideLoading(),o.queryTodo(),t})).catch((function(t){console.error(t),s["a"].hideLoading()})))},queryTodo:function(){var t=this;s["a"].showLoading({title:"正在查询..."});var o=s["a"].cloud.database();o.collection("todos").doc(this.data.todoId).get({success:function(o){t.setData({description:o.data.description,done:o.data.done}),console.log("[数据库] [查询记录] 成功: ",o)},fail:function(t){s["a"].showToast({icon:"none",title:"查询记录失败"}),console.error("[数据库] [查询记录] 失败：",t)},complete:function(){s["a"].hideLoading()}})},updateTodo:function(){var t=this;if(!this.data.updating&&this.data.todoId){var o=this.data,e=o.todoId,a=o.description;if(a){this.setData({updating:!0});var i=s["a"].cloud.database();i.collection("todos").doc(e).update({data:{description:a},success:function(){console.log("he"),s["a"].showToast({title:"更新成功"}),s["a"].navigateBack()},fail:function(t){s["a"].showToast({icon:"none",title:"更新失败"}),console.error("[数据库] [更新记录] 失败：",t)},complete:function(){t.setData({updating:!1})}})}}},removeTodo:function(){var t=this;if(!this.data.deleting&&this.data.todoId){var o=this.data.todoId;this.setData({deleting:!0});var e=s["a"].cloud.database();e.collection("todos").doc(o).remove({success:function(){s["a"].showToast({title:"删除成功"}),s["a"].navigateBack()},fail:function(t){s["a"].showToast({icon:"none",title:"删除失败"}),console.error("[数据库] [删除记录] 失败：",t)},complete:function(){t.setData({deleting:!1})}})}},onInputContent:function(t){this.setData({description:t.detail.value})}});var c=void 0,l=(e("44e1"),e("4d0b"),e("2877")),u=Object(l["a"])(c,a,i,!1,null,"4bad6b4b",null);o["default"]=u.exports},fba2:function(t,o,e){}}]);
//# sourceMappingURL=chunk-e93df450.def29dc1.js.map