(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1091af2d"],{"1b0e":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("onekit-page",[a("import",{attrs:{src:"../../../common/head.vue"}}),a("import",{attrs:{src:"../../../common/foot.vue"}}),a("onekit-view",{staticClass:"container"},[a("onekit-view",{staticClass:"page-body"},[a("onekit-view",{staticClass:"page-section"},[a("onekit-view",{staticClass:"weui-cells__title"},[a("onekit-view",[e._v("云调用是云开发提供的基于云函数使用小程序开放接口的能力")])],1),a("onekit-view",{staticClass:"weui-cells__title"},[a("onekit-view",[e._v("发送模板消息需在手机上测试")])],1),a("onekit-view",{staticClass:"weui-cells weui-cells_after-title"},[a("onekit-view",{staticClass:"page-body-info"},[a("onekit-view",{staticClass:"progress-figure"},["dark"===e.theme?a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/API/resources/kind/device_dark.png"}}):a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/API/resources/kind/device.png"}}),e._v('"+\' \'+sendTemplateMessageResult && "success"+\' \'+sendTemplateMessageError && "fail"">'),"dark"===e.theme?a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/cloud/resources/kind/scf_dark.png"}}):a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/cloud/resources/kind/scf.png"}}),e._v('"+\' \'+sendTemplateMessageResult && "success"+\' \'+sendTemplateMessageError && "fail"">'),"dark"===e.theme?a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/API/resources/kind/device_dark.png"}}):a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/API/resources/kind/device.png"}})],1),a("onekit-view",{staticClass:"data-area"},[e.sendTemplateMessageResult?a("onekit-view",{staticClass:"data-text"},[a("onekit-icon",{attrs:{type:"success"}}),a("onekit-text",[e._v("发送模板消息成功，返回微信主窗口查看")])],1):e._e(),a("onekit-view",{directives:[{name:"elif",rawName:"v-elif",value:e.sendTemplateMessageError,expression:"sendTemplateMessageError"}],staticClass:"data-text"},[a("onekit-icon",{attrs:{type:"warn",color:"#F43530"}}),a("onekit-text",[e._v("发送失败")])],1)],1),a("onekit-view",{staticClass:"btn-area"},[a("onekit-form",{attrs:{"report-submit":""},on:{submit:e.sendTemplateMessageViaCloudFunction}},[a("onekit-button",{attrs:{"form-type":"submit",loading:e.cloudLoading}},[e._v("发送模板消息")])],1)],1)],1)],1),a("onekit-view",{staticClass:"weui-cells__title"}),a("onekit-view",{staticClass:"weui-cells weui-cells_after-title"},[a("onekit-view",{staticClass:"page-body-info"},[a("onekit-view",{staticClass:"progress-figure"},["dark"===e.theme?a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/API/resources/kind/device_dark.png"}}):a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/API/resources/kind/device.png"}}),e._v('"+\' \'+getWXACodeResult && "success"+\' \'+getWXACodeError && "fail"">'),"dark"===e.theme?a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/cloud/resources/kind/scf_dark.png"}}):a("onekit-image",{staticClass:"progress-icon",attrs:{src:"/page/cloud/resources/kind/scf.png"}})],1),e.getWXACodeResult?a("onekit-view",{staticClass:"progress-figure"},[a("onekit-image",{attrs:{src:e.getWXACodeResult.result,mode:"aspectFit"}})],1):e._e(),a("onekit-view",{staticClass:"data-area"},[e.getWXACodeResult?a("onekit-view",{staticClass:"data-text"},[a("onekit-icon",{attrs:{type:"success"}}),a("onekit-text",[e._v("获取成功")])],1):e._e(),a("onekit-view",{directives:[{name:"elif",rawName:"v-elif",value:e.getWXACodeError,expression:"getWXACodeError"}],staticClass:"data-text"},[a("onekit-icon",{attrs:{type:"warn",color:"#F43530"}}),a("onekit-text",[e._v("获取失败")])],1)],1),a("onekit-view",{staticClass:"btn-area"},[a("onekit-button",{attrs:{loading:e.cloudLoading},on:{tap:e.getWXACodeViaCloudFunction}},[e._v("获取小程序码")])],1)],1)],1)],1)],1)],1)],1)},i=[],o=a("711f"),n=a("79f0");Object(o["OnekitPage"])({onShareAppMessage:function(){return{title:"云函数中使用微信开放能力",path:"page/cloud/pages/scf-openapi/scf-openapi"}},data:{sendTemplateMessageResult:"",sendTemplateMessageError:!1,getWXACodeResult:"",getWXACodeError:!1,sendTemplateMessageLoading:!1,getWXACodeLoading:!1,theme:"light"},onLoad:function(){var e=this;this.setData({theme:n["a"].getSystemInfoSync().theme||"light"}),n["a"].onThemeChange&&n["a"].onThemeChange((function(t){var a=t.theme;e.setData({theme:a})}))},sendTemplateMessageViaCloudFunction:function(e){var t=this;this.setData({sendTemplateMessageResult:"",sendTemplateMessageError:!1,sendTemplateMessageLoading:!0}),n["a"].cloud.callFunction({name:"openapi",data:{action:"sendTemplateMessage",formId:e.detail.formId}}).then((function(e){t.setData({sendTemplateMessageResult:e,sendTemplateMessageLoading:!1}),console.log("[云调用] [发送模板消息] 成功: ",e)})).catch((function(e){t.setData({sendTemplateMessageError:!0,sendTemplateMessageLoading:!1}),console.error("[云调用] [发送模板消息] 失败: ",e)}))},getWXACodeViaCloudFunction:function(){var e=this;this.setData({getWXACodeResult:"",getWXACodeError:!1,getWXACodeLoading:!0}),n["a"].cloud.callFunction({name:"openapi",data:{action:"getWXACode"}}).then((function(t){e.setData({getWXACodeResult:t,getWXACodeLoading:!1}),console.log("[云调用] [获取小程序码]] 成功: ",t)})).catch((function(t){e.setData({getWXACodeError:!0,getWXACodeLoading:!1}),console.error("[云调用] [获取小程序码] 失败: ",t)}))},queryServerDataViaClient:function(){var e=this,t=n["a"].cloud.database();this.setData({clientLoading:!0,serverDataClient:"",serverDataClientError:!1}),t.collection("perm4").where({_openid:"server"}).get({success:function(t){var a=t.data&&t.data[0]||{};e.setData({serverDataClient:a.data}),console.log("[数据库] [查询记录] 成功: ",t)},fail:function(t){e.setData({serverDataClientError:!0}),console.error("[数据库] [查询记录] 失败：",t)},complete:function(){e.setData({clientLoading:!1})}})},queryServerDataViaCloudFunction:function(){var e=this;this.setData({cloudLoading:!0,serverDataCloud:"",serverDataCloudError:!1}),n["a"].cloud.callFunction({name:"getServerDataDemo",data:{},success:function(t){console.log("[云函数] [getServerDataDemo] res: ",t.result);var a=t.result.data&&t.result.data[0]||{};e.setData({serverDataCloud:a.data})},fail:function(t){e.setData({serverDataCloudError:!0}),console.error("[云函数] [getServerDataDemo] 调用失败",t)},complete:function(){e.setData({cloudLoading:!1})}})}});var r=void 0,c=(a("79d4"),a("6df0"),a("2877")),l=Object(c["a"])(r,s,i,!1,null,"3089c88f",null);t["default"]=l.exports},"6df0":function(e,t,a){"use strict";var s=a("ceaa"),i=a.n(s);i.a},"79d4":function(e,t,a){"use strict";var s=a("ea83"),i=a.n(s);i.a},ceaa:function(e,t,a){},ea83:function(e,t,a){}}]);
//# sourceMappingURL=chunk-1091af2d.12b44926.js.map