{"version":3,"sources":["webpack:///./node_modules/core-js/modules/web.dom-collections.for-each.js","webpack:///./node_modules/core-js/internals/array-for-each.js","webpack:///./src/packageAPI/pages/bluetooth/bluetooth.vue?b9ba","webpack:///./src/packageAPI/pages/bluetooth/bluetooth.js","webpack:///./src/packageAPI/pages/bluetooth/bluetooth.js?ce29","webpack:///./src/packageAPI/pages/bluetooth/bluetooth.vue","webpack:///./node_modules/core-js/modules/es.array.for-each.js","webpack:///./src/packageAPI/pages/bluetooth/bluetooth.css?9bce","webpack:///./src/onekit/onekit.css?a21a","webpack:///./node_modules/core-js/modules/es.array.join.js","webpack:///./node_modules/core-js/modules/es.array-buffer.constructor.js","webpack:///./node_modules/core-js/modules/es.array.map.js"],"names":["global","DOMIterables","forEach","createNonEnumerableProperty","COLLECTION_NAME","Collection","CollectionPrototype","prototype","error","$forEach","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","module","exports","callbackfn","this","arguments","length","undefined","render","_vm","_h","$createElement","_c","_self","attrs","staticClass","_v","_s","devices","_l","item","index","deviceId","name","localName","on","createBLEConnection","staticStyle","RSSI","utils","max","len","advertisServiceUUIDs","openBluetoothAdapter","stopBluetoothDevicesDiscovery","changeMode","writeBLECharacteristicValue","_e","closeBLEConnection","uuid","value","staticRenderFns","inArray","arr","key","val","i","ab2hex","buffer","hexArr","Array","map","call","Uint8Array","bit","toString","slice","join","OnekitPage","onShareAppMessage","title","path","data","connected","chs","onUnload","closeBluetoothAdapter","wx","success","res","console","log","startBluetoothDevicesDiscovery","fail","errCode","showModal","content","showCancel","onBluetoothAdapterStateChange","available","getBluetoothAdapterState","discovering","onBluetoothDeviceFound","_discoveryStarted","allowDuplicatesKey","complete","device","foundDevices","idx","setData","e","ds","currentTarget","dataset","showLoading","getBLEDeviceServices","hideLoading","canWrite","navigateTo","url","services","isPrimary","getBLEDeviceCharacteristics","serviceId","characteristics","properties","read","readBLECharacteristicValue","characteristicId","write","_deviceId","_serviceId","_characteristicId","notify","indicate","notifyBLECharacteristicValueChange","state","onBLECharacteristicValueChange","characteristic","showToast","ArrayBuffer","dataView","DataView","setUint8","Math","random","component","$","target","proto","forced","IndexedObject","toIndexedObject","nativeJoin","ES3_STRINGS","Object","separator","arrayBufferModule","setSpecies","ARRAY_BUFFER","NativeArrayBuffer","$map","arrayMethodHasSpeciesSupport","HAS_SPECIES_SUPPORT"],"mappings":"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","file":"js/chunk-5d86f560.b634d55a.js","sourcesContent":["var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n}\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\nmodule.exports = (!STRICT_METHOD || !USES_TO_LENGTH) ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n} : [].forEach;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('onekit-page',[_c('import',{attrs:{\"src\":\"../../../common/head.vue\"}}),_c('import',{attrs:{\"src\":\"../../../common/foot.vue\"}}),_c('onekit-view',{staticClass:\"container\"},[_c('onekit-view',{staticClass:\"page-body\"},[_c('onekit-view',{staticClass:\"page-section\"},[_c('onekit-view',{staticClass:\"page-body-info\"},[_c('onekit-view',{staticClass:\"devices_summary\"},[_vm._v(\"已发现 \"+_vm._s(_vm.devices.length)+\" 个外围设备：\")]),_c('onekit-scroll-view',{staticClass:\"device_list\",attrs:{\"scroll-y\":\"\",\"scroll-with-animation\":\"\"}},_vm._l((_vm.devices),function(item,index){return _c('onekit-view',{staticClass:\"device_item\",attrs:{\"data-device-id\":item.deviceId,\"data-name\":item.name || item.localName,\"hover-class\":\"device_item_hover\"},on:{\"tap\":_vm.createBLEConnection}},[_c('onekit-view',{staticStyle:{\"font-size\":\"16px\"}},[_vm._v(_vm._s(item.name))]),_c('onekit-view',{staticStyle:{\"font-size\":\"10px\"}},[_vm._v(\"信号强度: \"+_vm._s(item.RSSI)+\"dBm (\"+_vm._s(_vm.utils.max(0, item.RSSI + 100))+\"%)\")]),_c('onekit-view',{staticStyle:{\"font-size\":\"10px\"}},[_vm._v(\"UUID: \"+_vm._s(item.deviceId))]),_c('onekit-view',{staticStyle:{\"font-size\":\"10px\"}},[_vm._v(\"Service数量: \"+_vm._s(_vm.utils.len(item.advertisServiceUUIDs)))])],1)}),1)],1),_c('onekit-view',{staticClass:\"btn-area\"},[_c('onekit-button',{attrs:{\"type\":\"primary\"},on:{\"tap\":_vm.openBluetoothAdapter}},[_vm._v(\"开始扫描\")]),_c('onekit-button',{on:{\"tap\":_vm.stopBluetoothDevicesDiscovery}},[_vm._v(\"停止扫描\")])],1),_c('onekit-view',{staticClass:\"btn-area\"},[_c('onekit-button',{attrs:{\"type\":\"primary\"},on:{\":tap\":_vm.changeMode}},[_vm._v(\" 进去从机模式 \")])],1)],1)],1),(_vm.connected)?_c('onekit-view',{staticClass:\"connected_info\"},[_c('onekit-view',[_c('onekit-text',[_vm._v(\"已连接到 \"+_vm._s(_vm.name))]),_c('onekit-view',{staticClass:\"operation\"},[(_vm.canWrite)?_c('onekit-button',{attrs:{\"size\":\"mini\"},on:{\"tap\":_vm.writeBLECharacteristicValue}},[_vm._v(\"写数据\")]):_vm._e(),_c('onekit-button',{attrs:{\"size\":\"mini\"},on:{\"tap\":_vm.closeBLEConnection}},[_vm._v(\"断开连接\")])],1)],1),_vm._l((_vm.chs),function(item,index){return _c('onekit-view',{staticStyle:{\"font-size\":\"12px\",\"margin-top\":\"10px\"}},[_c('onekit-view',[_vm._v(\"特性UUID: \"+_vm._s(item.uuid))]),_c('onekit-view',[_vm._v(\"特性值: \"+_vm._s(item.value))])],1)})],2):_vm._e()],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import PAGE_JSON from './bluetooth.json';\nimport {OnekitApp,OnekitPage,OnekitComponent} from \"../../../onekit/onekit.js\";\nimport wx from \"../../../onekit/wx.js\";\nfunction inArray(arr,key,val){\n    for(var i = 0;i < arr.length;i++){\n        if(arr[i][key] === val){\n            return i;\n        }\n    };\n    return -1;\n};\nfunction ab2hex(buffer){\n    const hexArr = Array.prototype.map.call(new Uint8Array(buffer),function(bit){\n        return ('00' + bit.toString(16)).slice(-2);\n    });\n    return hexArr.join('');\n};\nOnekitPage({\n    onShareAppMessage:function(){\n        return {\n            title:'蓝牙',\n            path:'packageAPI/pages/bluetooth/bluetooth'\n        };\n    },\n    data:{\n        devices:[\n        ],\n        connected:false,\n        chs:[\n        ]\n    },\n    onUnload:function(){\n        this.closeBluetoothAdapter();\n    },\n    openBluetoothAdapter:function(){\n        wx.openBluetoothAdapter({\n            success:(res)=>{\n                console.log('openBluetoothAdapter success',res);\n                this.startBluetoothDevicesDiscovery();\n            },\n            fail:(res)=>{if(res.errCode === 10001){\n                wx.showModal({\n                    title:'错误',\n                    content:'未找到蓝牙设备, 请打开蓝牙后重试。',\n                    showCancel:false\n                });\n                wx.onBluetoothAdapterStateChange(function(res){\n                    if(res && res.available){\n                        this.startBluetoothDevicesDiscovery();\n                    }\n                });\n            }}\n        });\n    },\n    getBluetoothAdapterState:function(){\n        wx.getBluetoothAdapterState({\n            success:(res)=>{\n                console.log('getBluetoothAdapterState',res);\n                if(res.discovering){\n                    this.onBluetoothDeviceFound();\n                } else if(res.available){\n                    this.startBluetoothDevicesDiscovery();\n                }\n            }\n        });\n    },\n    startBluetoothDevicesDiscovery:function(){\n        if(this._discoveryStarted){\n            return;\n        }\n        this._discoveryStarted = true;\n        wx.startBluetoothDevicesDiscovery({\n            allowDuplicatesKey:true,\n            success:(res)=>{\n                console.log('startBluetoothDevicesDiscovery success',res);\n                this.onBluetoothDeviceFound();\n            }\n        });\n    },\n    stopBluetoothDevicesDiscovery:function(){\n        wx.stopBluetoothDevicesDiscovery({\n            complete:()=>{this._discoveryStarted = false}\n        });\n    },\n    onBluetoothDeviceFound:function(){\n        wx.onBluetoothDeviceFound((res)=>{res.devices.forEach((device)=>{\n            if(!device.name && !device.localName){\n                return;\n            }\n            const foundDevices = this.data.devices;\n            const idx = inArray(foundDevices,'deviceId',device.deviceId);\n            const data = {};\n            if(idx === -1){\n                data[`devices[${foundDevices.length}]`] = device;\n            } else {\n                data[`devices[${idx}]`] = device;\n            }\n            this.setData(data);\n        })});\n    },\n    createBLEConnection:function(e){\n        const ds = e.currentTarget.dataset;\n        const deviceId = ds.deviceId;\n        const name = ds.name;\n        wx.showLoading();\n        wx.createBLEConnection({\n            deviceId:deviceId,\n            success:()=>{\n                this.setData({\n                    connected:true,\n                    name:name,\n                    deviceId:deviceId\n                });\n                this.getBLEDeviceServices(deviceId);\n            },\n            complete:function(){\n                wx.hideLoading();\n            }\n        });\n        this.stopBluetoothDevicesDiscovery();\n    },\n    closeBLEConnection:function(){\n        wx.closeBLEConnection({\n            deviceId:this.data.deviceId\n        });\n        this.setData({\n            connected:false,\n            chs:[\n            ],\n            canWrite:false\n        });\n    },\n    changeMode:function(){\n        wx.navigateTo({\n            url:'./slave/slave'\n        });\n    },\n    getBLEDeviceServices:function(deviceId){\n        wx.getBLEDeviceServices({\n            deviceId:deviceId,\n            success:(res)=>{for(var i = 0;i < res.services.length;i++){\n                if(res.services[i].isPrimary){\n                    this.getBLEDeviceCharacteristics(deviceId,res.services[i].uuid);\n                    return;\n                }\n            }}\n        });\n    },\n    getBLEDeviceCharacteristics:function(deviceId,serviceId){\n        wx.getBLEDeviceCharacteristics({\n            deviceId:deviceId,\n            serviceId:serviceId,\n            success:(res)=>{\n                console.log('getBLEDeviceCharacteristics success',res.characteristics);\n                for(var i = 0;i < res.characteristics.length;i++){\n                    const item = res.characteristics[i];\n                    if(item.properties.read){\n                        wx.readBLECharacteristicValue({\n                            deviceId:deviceId,\n                            serviceId:serviceId,\n                            characteristicId:item.uuid\n                        });\n                    }\n                    if(item.properties.write){\n                        this.setData({\n                            canWrite:true\n                        });\n                        this._deviceId = deviceId;\n                        this._serviceId = serviceId;\n                        this._characteristicId = item.uuid;\n                        console.log('write');\n                        this.writeBLECharacteristicValue();\n                    }\n                    if(item.properties.notify || item.properties.indicate){\n                        wx.notifyBLECharacteristicValueChange({\n                            deviceId:deviceId,\n                            serviceId:serviceId,\n                            characteristicId:item.uuid,\n                            state:true\n                        });\n                    }\n                };\n            },\n            fail:function(res){\n                console.error('getBLEDeviceCharacteristics',res);\n            }\n        });\n        wx.onBLECharacteristicValueChange((characteristic)=>{\n            const idx = inArray(this.data.chs,'uuid',characteristic.characteristicId);\n            const data = {};\n            if(idx === -1){\n                data[`chs[${this.data.chs.length}]`] = {\n                    uuid:characteristic.characteristicId,\n                    value:ab2hex(characteristic.value)\n                };\n            } else {\n                data[`chs[${idx}]`] = {\n                    uuid:characteristic.characteristicId,\n                    value:ab2hex(characteristic.value)\n                };\n            }\n            wx.showToast({\n                title:'收到从机数据'\n            });\n            this.setData(data);\n        });\n    },\n    writeBLECharacteristicValue:function(){\n        const buffer = new ArrayBuffer(1);\n        const dataView = new DataView(buffer);\n        dataView.setUint8(0,(Math.random() * 19) | 0);\n        wx.writeBLECharacteristicValue({\n            deviceId:this._deviceId,\n            serviceId:this._serviceId,\n            characteristicId:this._characteristicId,\n            value:buffer,\n            success:function(){\n                console.log('writeBLECharacteristicValue: 成功');\n            },\n            fail:function(){\n                console.log('writeBLECharacteristicValue: 失败');\n            },\n            complete:function(){\n                console.log('writeBLECharacteristicValue: 结束');\n            }\n        });\n    },\n    closeBluetoothAdapter:function(){\n        wx.closeBluetoothAdapter();\n        this._discoveryStarted = false;\n    }\n});\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/eslint-loader/index.js??ref--13-0!./bluetooth.js?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/eslint-loader/index.js??ref--13-0!./bluetooth.js?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./bluetooth.vue?vue&type=template&id=0daa11f2&scoped=true&\"\nimport script from \"./bluetooth.js?vue&type=script&lang=js&\"\nexport * from \"./bluetooth.js?vue&type=script&lang=js&\"\nimport style0 from \"@/onekit/onekit.css?vue&type=style&index=0&id=0daa11f2&scoped=true&lang=css&\"\nimport style1 from \"./bluetooth.css?vue&type=style&index=1&id=0daa11f2&scoped=scoped&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0daa11f2\",\n  null\n  \n)\n\nexport default component.exports","'use strict';\nvar $ = require('../internals/export');\nvar forEach = require('../internals/array-for-each');\n\n// `Array.prototype.forEach` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n$({ target: 'Array', proto: true, forced: [].forEach != forEach }, {\n  forEach: forEach\n});\n","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./bluetooth.css?vue&type=style&index=1&id=0daa11f2&scoped=scoped&lang=css&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./bluetooth.css?vue&type=style&index=1&id=0daa11f2&scoped=scoped&lang=css&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./onekit.css?vue&type=style&index=0&id=0daa11f2&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!./onekit.css?vue&type=style&index=0&id=0daa11f2&scoped=true&lang=css&\"","'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar arrayBufferModule = require('../internals/array-buffer');\nvar setSpecies = require('../internals/set-species');\n\nvar ARRAY_BUFFER = 'ArrayBuffer';\nvar ArrayBuffer = arrayBufferModule[ARRAY_BUFFER];\nvar NativeArrayBuffer = global[ARRAY_BUFFER];\n\n// `ArrayBuffer` constructor\n// https://tc39.github.io/ecma262/#sec-arraybuffer-constructor\n$({ global: true, forced: NativeArrayBuffer !== ArrayBuffer }, {\n  ArrayBuffer: ArrayBuffer\n});\n\nsetSpecies(ARRAY_BUFFER);\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n// FF49- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('map');\n\n// `Array.prototype.map` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n"],"sourceRoot":""}